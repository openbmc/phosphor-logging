{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f7a49c9d_37bf4fd7",
        "filename": "extensions/openpower-pels/pel.cpp",
        "patchSetId": 3
      },
      "lineNbr": 611,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2023-01-09T21:48:54Z",
      "side": 1,
      "message": "ouch, hard coded sleeps. I take it this is a \"lessons learned\" from others that did this? No \"synch\" command we can send to the journal?",
      "revId": "71bdca38f972cee7ab1c70bb2d731c022be46d93",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67b2922c_2b42a176",
        "filename": "extensions/openpower-pels/pel.cpp",
        "patchSetId": 3
      },
      "lineNbr": 611,
      "author": {
        "id": 1000008
      },
      "writtenOn": "2023-01-09T23:17:09Z",
      "side": 1,
      "message": "Shawn figured out this delay empirically.\n\nI think the alternative is what log_manager does: https://github.com/openbmc/phosphor-logging/blob/master/log_manager.cpp#L612  which seems to send the journal a signal, though I\u0027m not sure what that signal does.  I could go either way... what would you prefer?",
      "parentUuid": "f7a49c9d_37bf4fd7",
      "revId": "71bdca38f972cee7ab1c70bb2d731c022be46d93",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fe5c220c_7dcfb346",
        "filename": "extensions/openpower-pels/pel.cpp",
        "patchSetId": 3
      },
      "lineNbr": 611,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2023-01-13T20:32:22Z",
      "side": 1,
      "message": "Wow, that\u0027s some complicated code. I see there\u0027s a systemd-journal-flush.service but not a systemd-journal-synch.service which is unfortunate, because then you could just start the service.\n\nMy vote would be to just run \"journalctl --sync\" (https://www.freedesktop.org/software/systemd/man/systemd-journald.service.html). It\u0027s not the best for error handling to do that but it feels better then a hard coded sleep or that really complex signal code.",
      "parentUuid": "67b2922c_2b42a176",
      "revId": "71bdca38f972cee7ab1c70bb2d731c022be46d93",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "162dee4f_30e3d474",
        "filename": "extensions/openpower-pels/pel.cpp",
        "patchSetId": 3
      },
      "lineNbr": 611,
      "author": {
        "id": 1000008
      },
      "writtenOn": "2023-01-17T20:04:24Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fe5c220c_7dcfb346",
      "revId": "71bdca38f972cee7ab1c70bb2d731c022be46d93",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d1ad5b3b_52f468e1",
        "filename": "extensions/openpower-pels/pel.cpp",
        "patchSetId": 3
      },
      "lineNbr": 611,
      "author": {
        "id": 1000003
      },
      "writtenOn": "2023-01-17T22:03:13Z",
      "side": 1,
      "message": "journalSync() is a copy/paste from \"journalctl --sync\", it was done that way because using system() is discouraged - https://github.com/openbmc/docs/blob/master/CONTRIBUTING.md#best-practices-for-c",
      "parentUuid": "162dee4f_30e3d474",
      "revId": "71bdca38f972cee7ab1c70bb2d731c022be46d93",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0ae8bce7_ac9ae653",
        "filename": "extensions/openpower-pels/pel.cpp",
        "patchSetId": 3
      },
      "lineNbr": 611,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2023-01-17T22:57:50Z",
      "side": 1,
      "message": "Yeah, I don\u0027t think there\u0027s an easy answer to this one. Copy/pasting code (that could change without us knowing) is also a bit dangerous. My vote is we just call journalctl command line, at least it abstracts us from the implementation and if it does run into issues, we\u0027re just missing some traces in an error log.",
      "parentUuid": "d1ad5b3b_52f468e1",
      "revId": "71bdca38f972cee7ab1c70bb2d731c022be46d93",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2c35c428_a90fe7bd",
        "filename": "extensions/openpower-pels/pel.cpp",
        "patchSetId": 3
      },
      "lineNbr": 611,
      "author": {
        "id": 1000008
      },
      "writtenOn": "2023-01-17T22:58:24Z",
      "side": 1,
      "message": "I took at look at what the latest journalctl --sync would be doing: https://github.com/systemd/systemd/blob/main/src/journal/journalctl.c#L2059 and it appears to just make a varlink call into the journal daemon.\n\nIf I followed it right, that appears to use an sd_event_add_defer() (in the journal daemon) to do the sync... which makes me wonder if the sync is even done by the time journalctl --sync returns.",
      "parentUuid": "d1ad5b3b_52f468e1",
      "revId": "71bdca38f972cee7ab1c70bb2d731c022be46d93",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}