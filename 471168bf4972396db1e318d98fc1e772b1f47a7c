{
  "comments": [
    {
      "key": {
        "uuid": "b3477d20_32b0ac52",
        "filename": "extensions/openpower-pels/repository.cpp",
        "patchSetId": 5
      },
      "lineNbr": 418,
      "author": {
        "id": 1001063
      },
      "writtenOn": "2021-08-28T00:08:44Z",
      "side": 1,
      "message": "@matt, This change is causing the testcases to break. I am not sure how to fix this as obmcId is the one in manager.cpp and our repo has this id set. But rest of the code goes by pelID and when I try to set the hmcState it will not find it as the ID will not match. I had to change line 420 to ObmcId to satisfy that case but the code in host_notifier.cpp would break and its contradicting to the assumption we made\nbool HostNotifier::enqueueRequired(uint32_t id) const\n{\n    bool required \u003d true;\n    Repository::LogID i{Repository::LogID::Pel{id}};\n\n    // Manufacturing testing may turn off sending up PELs\n    if (!_dataIface.getHostPELEnablement())\n    {\n        return false;\n    }\n\n    if (auto attributes \u003d _repo.getPELAttributes(i); attributes)\n    {\n        auto a \u003d attributes.value().get();\n\n        if ((a.hostState \u003d\u003d TransmissionState::acked) ||\n            (a.hostState \u003d\u003d TransmissionState::badPEL))\n        {\n            required \u003d false;\n        }\n        else if (a.actionFlags.test(hiddenFlagBit) \u0026\u0026\n                 (a.hmcState \u003d\u003d TransmissionState::acked)) \u003c\u003c\u003c\u003c this is going to break as we set hmcState on ObmcId but we set pelId at the top of function\n        {\n            required \u003d false;\n        }\n        else if (a.actionFlags.test(dontReportToHostFlagBit))\n        {\n            required \u003d false;\n        }\n    }\n    else\n    {\n        using namespace phosphor::logging;\n        log\u003clevel::ERR\u003e(\"Host Enqueue: Unable to find PEL ID in repository\",\n                        entry(\"PEL_ID\u003d0x%X\", id));\n        required \u003d false;\n    }\n\n    return required;\n}",
      "revId": "471168bf4972396db1e318d98fc1e772b1f47a7c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    }
  ]
}